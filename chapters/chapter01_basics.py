"""
第1章: 線形計画法の基礎
=======================

この章では、線形計画法の基本的な概念を学びます。
"""


def print_section(title: str) -> None:
    """セクションタイトルを表示する"""
    print("\n" + "=" * 60)
    print(f" {title}")
    print("=" * 60 + "\n")


# ============================================================
# 1.1 線形計画法とは
# ============================================================

print_section("1.1 線形計画法とは")

explanation = """
線形計画法（Linear Programming, LP）は、線形の目的関数を
線形の制約条件の下で最大化または最小化する数学的手法です。

【基本構成要素】

1. 決定変数（Decision Variables）
   - 最適化したい変数（x, y など）
   - 例：製品Aの生産量、製品Bの生産量

2. 目的関数（Objective Function）
   - 最大化または最小化したい関数
   - 例：利益 = 20x + 30y を最大化

3. 制約条件（Constraints）
   - 決定変数が満たすべき条件
   - 例：x + y <= 100（総生産量の制限）

4. 非負制約（Non-negativity Constraints）
   - 通常、変数は0以上
   - 例：x >= 0, y >= 0
"""
print(explanation)


# ============================================================
# 1.2 簡単な例：グラフによる理解
# ============================================================

print_section("1.2 簡単な例：グラフによる理解")

example1 = """
【例題】次の線形計画問題を考えます：

  最大化:  z = x + 2y  （目的関数）

  制約条件:
    2x + y  <= 20  （赤の制約）
    -4x + 5y <= 10  （青の制約）
    -x + 2y >= -2   （黄の制約）
    x >= 0, y >= 0  （非負制約）

【グラフによる解釈】

各制約条件は平面上の直線を表し、その片側が許容される領域です。
すべての制約を満たす領域を「実行可能領域（Feasible Region）」と呼びます。

    y
    ^
    |     実行可能領域
    |    ／￣￣＼
    |   ／      ＼
    |  ／   ●    ＼  ← 最適解はここ（頂点）
    | ／          ＼
    |/            ＼
    +-----------------> x

線形計画問題の最適解は、必ず実行可能領域の頂点（コーナー）に存在します。
"""
print(example1)


# ============================================================
# 1.3 混合整数線形計画法（MILP）とは
# ============================================================

print_section("1.3 混合整数線形計画法（MILP）とは")

milp_explanation = """
混合整数線形計画法（Mixed-Integer Linear Programming, MILP）は、
線形計画法の拡張で、一部の変数が整数値のみを取る制約を加えたものです。

【変数の種類】

1. 連続変数（Continuous Variables）
   - 任意の実数値を取れる
   - 例：原材料の使用量（3.5kg など）

2. 整数変数（Integer Variables）
   - 整数値のみを取れる
   - 例：生産する製品の個数（5個、10個など）

3. 二値変数（Binary Variables）
   - 0または1のみを取れる
   - 例：工場を建設するかどうか（Yes=1, No=0）

【なぜMILPが重要か？】

実際の問題では、「飛行機の数」や「従業員の数」など、
整数でなければ意味をなさない変数が多く存在します。

二値変数は特に重要で、以下のような論理的な判断を表現できます：
- ある工場を稼働させるかどうか
- ある経路を使用するかどうか
- ある従業員をシフトに割り当てるかどうか
"""
print(milp_explanation)


# ============================================================
# 1.4 実行不能問題と非有界問題
# ============================================================

print_section("1.4 特殊なケース：実行不能問題と非有界問題")

special_cases = """
【実行不能問題（Infeasible Problem）】

すべての制約条件を同時に満たす解が存在しない場合、
その問題は「実行不能」と呼ばれます。

例：
  x + y <= 10
  x + y >= 20
  x >= 0, y >= 0

→ この制約を同時に満たすx, yは存在しません。


【非有界問題（Unbounded Problem）】

実行可能領域が無限に広がり、目的関数の値が
無限大（または無限小）になりうる場合です。

例：
  最大化: z = x + y
  制約: x >= 0, y >= 0

→ xもyも上限がないため、zは無限大まで増加できます。


【実務での注意点】

- 実行不能や非有界の結果が出た場合は、問題の定式化を見直す必要があります
- 制約条件の矛盾や、必要な制約の欠如が原因であることが多いです
"""
print(special_cases)


# ============================================================
# 1.5 線形計画法の応用分野
# ============================================================

print_section("1.5 線形計画法の応用分野")

applications = """
線形計画法は様々な分野で活用されています：

【製造業】
- 生産計画の最適化
- 原材料の配分
- 在庫管理

【物流・輸送】
- 配送ルートの最適化
- 倉庫の配置
- 輸送コストの最小化

【金融】
- ポートフォリオ最適化
- リスク管理
- 資源配分

【エネルギー】
- 電力網の最適化
- 発電計画
- エネルギーミックスの決定

【農業】
- 作付け計画
- 飼料配合の最適化
- 灌漑スケジューリング

【医療】
- 病床管理
- スタッフスケジューリング
- 治療計画
"""
print(applications)


# ============================================================
# 1.6 Pythonで使える主なライブラリ
# ============================================================

print_section("1.6 Pythonで使える主なライブラリ")

libraries = """
Pythonには線形計画法を解くための優れたライブラリがあります：

【SciPy】
- 科学計算のための汎用ライブラリ
- scipy.optimize.linprog() で線形計画問題を解ける
- 簡単な問題に適している
- 整数計画法は非対応

【PuLP】
- 線形計画法専用のPythonライブラリ
- 直感的な問題定義が可能
- 複数のソルバーに対応（CBC, GLPK, Gurobi など）
- 混合整数線形計画法にも対応

【その他のライブラリ】
- Pyomo: より複雑な最適化問題に対応
- CVXOPT: 凸最適化に特化
- OR-Tools (Google): 組合せ最適化に強い

【商用ソルバー】
- Gurobi: 高速で高機能（学術用途は無料）
- CPLEX (IBM): 大規模問題に対応
- XPRESS: 高性能な商用ソルバー

このチュートリアルでは、SciPyとPuLPを使用します。
"""
print(libraries)


# ============================================================
# まとめ
# ============================================================

print_section("第1章のまとめ")

summary = """
この章で学んだこと：

1. 線形計画法は、線形の目的関数を線形の制約条件下で最適化する手法

2. 基本構成要素：
   - 決定変数：最適化したい変数
   - 目的関数：最大化/最小化したい関数
   - 制約条件：変数が満たすべき条件

3. 混合整数線形計画法（MILP）は、整数変数を含む拡張版

4. 特殊なケース：
   - 実行不能問題：解が存在しない
   - 非有界問題：最適値が無限

5. Pythonでは SciPy と PuLP が主要なライブラリ

次の章では、SciPyを使った実際の実装方法を学びます！
"""
print(summary)


if __name__ == "__main__":
    print("\n" + "=" * 60)
    print(" 第1章 完了！")
    print(" 次は chapter02_scipy.py を実行してください")
    print("=" * 60)
